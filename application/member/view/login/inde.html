<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8"/>
    <title>七朵云登录</title>
    <link rel="stylesheet" href="__PUBLIC__/member/css/lib/bootstrap.min.css" type="text/css">
    <!--[if lt IE 9]>
    <script src="//cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="//cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" href="__PUBLIC__/member/css/less/style.css?v0.001"/>

    <!--<link rel="stylesheet/less" type="text/css" href="css/less/style.less?1.00">-->
    <!--<script type="text/javascript" src="js/lib/less.js"></script>-->
    <script src="http://res.wx.qq.com/connect/zh_CN/htmledition/js/wxLogin.js"></script>
    <link rel="stylesheet" href="https://console.qiduo.net//Public/Home/css/less/css.css">

</head>

<body class="log-qr">
<div class="qr-box container">
    <div class="qr-log">
        <div class="qr-title">
            <img style="width: 50%;height: 50%;" src="__PUBLIC__/member/img/qiduo.png" alt=""/>
        </div>
        <div class="qr">

            <div id="wxlogin">

            </div>
            <style>

            </style>
        </div>
        <div class="caption">
            <h5>微信扫码登录</h5>
            <p>
                <a class="txt-show">账号登录</a><span class="mlr">|</span>
                <a class="reg-show">注册账号</a>
            </p>
        </div>
    </div>
    <div class="txt-log">
        <form id="log-form" action="{:url('Login/go')}" method="post">
            <div class="qr-title">
                <img style="width: 50%;height: 50%;" src="__PUBLIC__/member/img/qiduo.png" alt=""/>
            </div>
            <div class="form-horizontal">
                <div class="form-group">
                    <input type="text" class="form-control" id="logName" name="username" placeholder="手机号/邮箱"/>
                </div>
                <div class="form-group">
                    <input type="password" class="form-control" id="logPass" name="password" placeholder="密码"/>
                </div>
                <div class="form-group">
                    <button type="submit" class="btn btn-ces">登录</button>
                </div>
            </div>
        </form>
        <div class="caption">
            <p>
                <a class="qr-show">二维码登录</a><span class="mlr">|</span>
                <a class="reg-show">注册账号<span class="mlr">|</span></a>
                <a class="txt-finds">重置密码</a>
            </p>
        </div>
    </div>
    <div class="txt-reg">
        <form id="reg-form" action="{:url('Login/add')}" method="post">
            <div class="qr-title">
                <img style="width: 50%;height: 50%;" src="__PUBLIC__/member/img/qiduo.png" alt=""/>
            </div>
            <div class="form-horizontal">
                <div class="form-group">
                    <input type="text" class="form-control" id="ename" name="username" placeholder="用户名"/>
                </div>
                <div class="form-group">
                    <input type="text" class="form-control" id="regTel" name="phone" placeholder="手机号"/>
                </div>
                <div class="form-group">
                    <input type="password" class="form-control" id="regPass" name="password" placeholder="密码"/>
                </div>
                <div class="form-group">
                    <input type="password" class="form-control" id="regPass2" name="repassword" placeholder="重复密码"/>
                </div>
                <div class="form-group">
                    <input type="text" class="form-control" name="email" id="regEmail" placeholder="邮箱"/>
                </div>
                <div class="input-group">
                    <input type="text" class="form-control" id="notecode" maxlength="6"
                           placeholder="请输入手机验证码" autocomplete="off">
                    <span class="input-group-btn" id="hqdx">
											        <button class="btn btn-primary" type="button"
                                                            onclick="timeedCount(60,1)"><span
                                                            class="pl5 pr5">获取验证码</span></button>
											    </span>
                </div>
                <div class="form-group">
                    <button class="btn btn-ces" type="submit">登录</button>
                </div>
            </div>
        </form>
        <div class="caption">
            <p>
                <a class="qr-show">二维码登录</a><span class="mlr">|</span>
                <a class="txt-show">账号登录</a>
            </p>
        </div>
    </div>
    <div class="txt-find">
        <div class="qr-title">
            <img style="width: 50%;height: 50%;" src="__PUBLIC__/member/img/qiduo.png" alt=""/>
        </div>
        <form id="reset-form" action="{:url('Login/reset')}" method="post">
            <div class="form-horizontal">
                <div class="form-group">
                    <input type="text" class="form-control" placeholder="手机号" name="phone" id="phone"/>
                </div>
                <div class="form-group">
                    <input type="password" class="form-control" placeholder="密码" name="password" id="passowrd"/>
                </div>
                <div class="form-group">
                    <input type="password" class="form-control" name="repassword" placeholder="重复密码" id="passowrd2"/>
                </div>
                <!-- <div class="form-group">
                    <input type="text" class="form-control" placeholder="邮箱" />
                </div> -->
                <div class="input-group">
                    <input type="text" class="form-control" id="notecode2" maxlength="6"
                           placeholder="请输入手机验证码" autocomplete="off">
                    <span class="input-group-btn" id="hqdx2">
											        <button class="btn btn-primary" type="button"
                                                            onclick="timeedCount2(60,1)"><span
                                                            class="pl5 pr5">获取验证码</span></button>
											    </span>
                </div>
                <div class="form-group">
                    <button type="submit" class="btn btn-ces">重置</button>
                </div>
            </div>
        </form>
        <div class="caption">
            <p>
                <a class="qr-show">二维码登录</a><span class="mlr">|</span>
                <a class="txt-show">账号登录<span class="mlr">|</span></a>
                <a class="reg-show">注册账号</a>
            </p>
        </div>
    </div>
</div>

<script type="text/javascript" src="__PUBLIC__/member/js/lib/jquery-1.11.0.js"></script>
<script type="text/javascript" src="__PUBLIC__/member/js/lib/bootstrap.min.js"></script>
<script type="text/javascript" src="__PUBLIC__/member/js/lib/jquery.nicescroll.js"></script>
<script type="text/javascript" src="__PUBLIC__/member/js/lib/jquery.qqFace.js"></script>
<script type="text/javascript" src="__PUBLIC__/member/js/lib/store.min.js"></script>
<script type="text/javascript" src="__PUBLIC__/member/js/lib/jquery.form.js"></script>
<script type="text/javascript" src="__PUBLIC__/member/js/app.js"></script>
<script>
    $('.qr-show').on('click', function () {
        $('.txt-reg').hide();
        $('.txt-log').hide();
        $('.qr-log').fadeIn();
        $('.txt-find').hide();
    })

    $('.txt-show').on('click', function () {
        $('.txt-reg').hide();
        $('.txt-log').fadeIn();
        $('.qr-log').hide();
        $('.txt-find').hide();

    })
    $('.txt-finds').on('click', function () {
        $('.txt-reg').hide();
        $('.txt-log').hide();
        $('.txt-find').fadeIn();
        $('.qr-log').hide();
    })
    $('.reg-show').on('click', function () {
        $('.txt-reg').fadeIn();
        $('.txt-log').hide();
        $('.qr-log').hide();
        $('.txt-find').hide();
    })
</script>

<script>
    option1 = ({
        beforeSend: function () {
            if ($("#log-form #logName").val() == '') {
                alert('请输入用户名！');
                console.log($("#reg-form #regYear").html())
                return false;
            }
            if ($("#log-form #logPass").val() == '') {
                alert('请输入密码！');
                return false;
            }
            if (!(/^[a-zA-Z][a-zA-Z0-9]{5,19}/.test($("#log-form #logPass").val()))) {
                alert('密码不正确！');
                return false;
            }
        },
        success: function (data) {
            if (data == 1) {
                window.location.href = "{:url('Index/index')}";
            } else if (data.length > 5) {
                window.location.href = 'https://mall.qiduo.net/index.php?s=/Shop/go_save/no/' + data;
            } else {
                alert('账号或密码错误！');
            }
        }
    });
    $("#log-form").ajaxForm(option1);
    option2 = ({
        beforeSend: function () {
            if ($("#reg-form #ename").val() == '') {
                alert('请输入用户名！');
                return false;
            }
            if (!(/^[\u4e00-\u9fa5]+$/i.test($("#reg-form #ename").val()))) {
                alert('用户名必须为中文！');
                return false;
            }
            if ($("#reg-form #regPass").val() == '') {
                alert('请输入密码！');
                return false;
            }
            if ($("#reg-form #regPass").val().length < 6) {
                alert('密码不能少于6位！');
                return false;
            }
            if ($("#reg-form #regPass2").val() == '') {
                alert('请输入确认密码！');
                return false;
            }
            if (!(/^[a-zA-Z][a-zA-Z0-9]{5,19}/.test($("#reg-form #regPass2").val()))) {
                alert('密码必须为中英文以英文字母开头最低6位！');
                return false;
            }
            if ($("#reg-form #regPass2").val() != $("#reg-form #regPass").val()) {
                alert('输入的密码与确认密码不同！');
                return false;
            }
            if ($("#reg-form #regEmail").val() == '') {
                alert('请输入邮箱地址！');
                return false;
            }
            if (!(/^(1[3-9][0-9])\d{8}$/.test($("#reg-form #regTel").val()))) {
                alert('电话号码输入有误！');
                return false;
            }
            if ($("#reg-form #regTel").val() == '') {
                alert('请输入电话号码！');
                return false;
            }
            if (!(/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/.test($("#reg-form #regEmail").val()))) {
                alert('邮箱地址输入有误！');
                return false;
            }
            if ($("#reg-form #notecode").val() == '') {
                alert('请输入手机验证码！');
                return false;
            }
            if ($("#reg-form #notecode").val() != yzm) {
                alert('手机验证码不正确！');
                return false;
            }
        },
        success: function (data) {
            if (data == 1) {
                alert("网页将会刷新！");
                window.location.href = "{:url('Index/index')}";
            } else {
                alert('表单提交失败');
            }
        }
    });
    $("#reg-form").ajaxForm(option2);
    option3 = ({
        beforeSend: function () {
            if ($("#reset-form #phone").val() == '') {
                alert('请输入您的手机号！');
                return false;
            }
            if ($("#reset-form #passowrd").val() == '') {
                alert('请输入密码！');
                return false;
            }
            if ($("#reset-form #passowrd2").val() == '') {
                alert('请输入确认密码密码！');
                return false;
            }
            if (!(/^[a-zA-Z][a-zA-Z0-9]{5,19}/.test($("#reset-form #passowrd").val()))) {
                alert('密码不正确！');
                return false;
            }
            if ($("#reset-form #passowrd").val() != $("#reset-form #passowrd2").val()) {
                alert('输入的密码与确认密码不同！');
                return false;
            }
            if ($("#reset-form #notecode").val() == '') {
                alert('请输入手机验证码！');
                return false;
            }
            if ($("#reset-form #notecode").val() != yzm2) {
                alert('手机验证码不正确！');
                return false;
            }
        },
        success: function (data) {
            if (data == 1) {
                alert('密码重置成功,请返回登录');
            } else if (data.length > 5) {
                window.location.href = 'https://mall.qiduo.net/index.php?s=/Shop/go_save/no/' + data;
            } else {
                alert('提交失败');
            }
        }
    });
    $("#reset-form").ajaxForm(option3);
</script>
<script>
    var yzm;
    var t = 1;
    function timeedCount(time, type) {
        times = time;
        //            $("#getVerfiyKey").val(times+'秒');
        var text = $("#regTel").val();
        if (!(/^(1[3-9][0-9])\d{8}$/.test($("#regTel").val()))) {
            $("#hqdx").html('<a class="btn btn-sm btn-primary" onclick="timeedCount(60,1)"><span class="pl5 pr5">获取手机验证码</span></a>');
            alert('电话号码输入有误！');
            return false;
        }
        $.ajax({
            url: "{:url('Login/phonetext')}",
            data: {'phone': text},
            asyn: false,
            type: 'post',
            success: function (d) {
                if (d == 1) {
                    alert('电话号码已注册！');
                    t = 1;
                } else {
                    if (type == 1) {
                        var phone = $('input[name=phone]').val();
                        if (t == 1) {
                            $.ajax({
                                url: "{:url('Login/bcesms')}",
                                data: {'phone': phone},
                                type: 'post',
                                success: function (d) {
                                    if (d != 1) {
                                        yzm = d;
                                    }
                                }
                            });
                        }
                        ;

                        t = 0;
                        $("#hqdx").html('<a class="btn btn-sm btn-primary"><span class="pl5 pr5">' + times + '秒</span></a>');
                        if (times > 0) {
                            times = times - 1;
                            t = setTimeout("timeedCount(times,1)", 1000);
                        } else {
                            clearTimeout(t);
                            $("#hqdx").html('<a class="btn btn-sm btn-primary" onclick="timeedCount(60,1)"><span class="pl5 pr5">获取手机验证码</span></a>');
                        }
                    }
                }
            }
        });

    }

    var yzm2;
    var t2 = 1;
    function timeedCount2(time, type) {
        times = time;
        //            $("#getVerfiyKey").val(times+'秒');
        var text = $("#phone").val();

        if (!(/^(1[3-9][0-9])\d{8}$/.test($("#phone").val()))) {
            $("#hqdx2").html('<a class="btn btn-sm btn-primary" onclick="timeedCount2(60,1)"><span class="pl5 pr5">获取手机验证码</span></a>');
            alert('电话号码输入有误！');
            return false;
        }
        $.ajax({
            url: "{:url('Login/phonetext')}",
            data: {'phone': text},
            asyn: false,
            type: 'post',
            success: function (d) {
                var phone = text;

                if (t2 == 1) {
                    $.ajax({
                        url: "{:url('Login/bcesms')}",
                        data: {'phone': phone},
                        type: 'post',
                        success: function (d) {
                            if (d != 1) {
                                yzm2 = d;
                            }
                        }
                    });
                }
                ;

                t2 = 0;
                $("#hqdx2").html('<a class="btn btn-sm btn-primary"><span class="pl5 pr5">' + times + '秒</span></a>');
                if (times > 0) {
                    times = times - 1;
                    t2 = setTimeout("timeedCount2(times,1)", 1000);
                } else {
                    clearTimeout(t2);
                    $("#hqdx2").html('<a class="btn btn-sm btn-primary" onclick="timeedCount2(60,1)"><span class="pl5 pr5">获取手机验证码</span></a>');
                }

            }

        });

    }
</script>
<script>
    var obj = new WxLogin({
        id: "wxlogin",
        appid: "wx73edafaf3103c67d",
        scope: "snsapi_login",
        redirect_uri: "http://v1.qiduo.net/member/Login/access_token",
        state: "",
        style: "white",
        href: "https://console.qiduo.net//Public/Home/css/less/css.css"
    });
</script>

</body>

</html>